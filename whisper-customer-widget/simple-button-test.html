<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simple Button Test</title>
  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    
    .test-container {
      max-width: 600px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      padding: 2rem;
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
    }
    
    .title {
      font-size: 2rem;
      font-weight: bold;
      text-align: center;
      margin-bottom: 1rem;
      color: #1f2937;
    }
    
    .description {
      text-align: center;
      color: #6b7280;
      margin-bottom: 2rem;
    }
    
    .controls {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 2rem;
    }
    
    .btn {
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 6px;
      background: #3b82f6;
      color: white;
      cursor: pointer;
      font-weight: 500;
      transition: background 0.2s;
    }
    
    .btn:hover {
      background: #2563eb;
    }
    
    .status {
      padding: 1rem;
      border-radius: 8px;
      margin: 1rem 0;
      font-weight: 500;
    }
    
    .status.success {
      background: #d1fae5;
      color: #065f46;
    }
    
    .status.error {
      background: #fee2e2;
      color: #991b1b;
    }
    
    .status.info {
      background: #dbeafe;
      color: #1e40af;
    }
    
    .debug {
      background: #1f2937;
      color: #f3f4f6;
      padding: 1rem;
      border-radius: 8px;
      font-family: monospace;
      font-size: 0.875rem;
      white-space: pre-wrap;
      max-height: 200px;
      overflow-y: auto;
    }
    
    /* æµ‹è¯•æŒ‰é’®æ ·å¼ */
    .test-chat-button {
      position: fixed !important;
      z-index: 9999 !important;
      width: 3.5rem !important;
      height: 3.5rem !important;
      border-radius: 50% !important;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15) !important;
      cursor: pointer !important;
      transition: all 0.3s ease-in-out !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      color: white !important;
      background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%) !important;
      border: none !important;
      outline: none !important;
      padding: 0 !important;
      margin: 0 !important;
      font-family: inherit !important;
      font-size: 1.5rem !important;
      line-height: 1 !important;
      bottom: 1.5rem !important;
      right: 1.5rem !important;
    }
    
    .test-chat-button:hover {
      background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%) !important;
      transform: scale(1.05) !important;
      box-shadow: 0 15px 35px rgba(59, 130, 246, 0.4) !important;
    }
    
    .test-chat-button--left {
      left: 1.5rem !important;
      right: auto !important;
    }
    
    .test-chat-button--dark {
      background: linear-gradient(135deg, #374151 0%, #1f2937 100%) !important;
    }
    
    .test-chat-button--dark:hover {
      background: linear-gradient(135deg, #4b5563 0%, #374151 100%) !important;
    }
    
    .content-area {
      height: 150vh;
      background: rgba(255,255,255,0.1);
      margin: 2rem 0;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.2rem;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="test-container">
    <h1 class="title">ğŸ”˜ ç®€å•æŒ‰é’®æµ‹è¯•</h1>
    <p class="description">
      æµ‹è¯•èŠå¤©æŒ‰é’®çš„åŸºæœ¬å®šä½å’Œæ ·å¼åŠŸèƒ½
    </p>
    
    <div id="status" class="status info">
      å‡†å¤‡æµ‹è¯•èŠå¤©æŒ‰é’®...
    </div>
    
    <div class="controls">
      <button class="btn" onclick="createButton()">åˆ›å»ºæŒ‰é’®</button>
      <button class="btn" onclick="togglePosition()">åˆ‡æ¢ä½ç½®</button>
      <button class="btn" onclick="toggleTheme()">åˆ‡æ¢ä¸»é¢˜</button>
      <button class="btn" onclick="removeButton()">ç§»é™¤æŒ‰é’®</button>
      <button class="btn" onclick="inspectButton()">æ£€æŸ¥æŒ‰é’®</button>
    </div>
    
    <div id="debug" class="debug"></div>
  </div>
  
  <div class="content-area">
    æ»šåŠ¨æµ‹è¯•åŒºåŸŸ - æŒ‰é’®åº”ä¿æŒå›ºå®šä½ç½®
  </div>

  <script>
    let chatButton = null;
    let isLeft = false;
    let isDark = false;

    function updateStatus(message, type = 'info') {
      const status = document.getElementById('status');
      status.className = `status ${type}`;
      status.textContent = message;
    }

    function addDebug(message) {
      const debug = document.getElementById('debug');
      const timestamp = new Date().toLocaleTimeString();
      debug.textContent += `[${timestamp}] ${message}\n`;
      debug.scrollTop = debug.scrollHeight;
    }

    function createButton() {
      if (chatButton) {
        removeButton();
      }

      addDebug('åˆ›å»ºèŠå¤©æŒ‰é’®...');
      
      chatButton = document.createElement('button');
      chatButton.className = 'test-chat-button';
      chatButton.innerHTML = 'ğŸ’¬';
      chatButton.setAttribute('aria-label', 'æ‰“å¼€èŠå¤©');
      
      // æ·»åŠ ç‚¹å‡»äº‹ä»¶
      chatButton.addEventListener('click', () => {
        addDebug('æŒ‰é’®è¢«ç‚¹å‡»ï¼');
        updateStatus('âœ… æŒ‰é’®ç‚¹å‡»äº‹ä»¶æ­£å¸¸å·¥ä½œ', 'success');
      });
      
      // æ·»åŠ æ‚¬åœäº‹ä»¶
      chatButton.addEventListener('mouseenter', () => {
        addDebug('é¼ æ ‡æ‚¬åœåœ¨æŒ‰é’®ä¸Š');
      });
      
      chatButton.addEventListener('mouseleave', () => {
        addDebug('é¼ æ ‡ç¦»å¼€æŒ‰é’®');
      });
      
      document.body.appendChild(chatButton);
      
      addDebug('æŒ‰é’®å·²åˆ›å»ºå¹¶æ·»åŠ åˆ°é¡µé¢');
      updateStatus('âœ… èŠå¤©æŒ‰é’®å·²åˆ›å»º', 'success');
    }

    function togglePosition() {
      if (!chatButton) {
        updateStatus('âŒ è¯·å…ˆåˆ›å»ºæŒ‰é’®', 'error');
        return;
      }

      isLeft = !isLeft;
      
      if (isLeft) {
        chatButton.classList.add('test-chat-button--left');
        addDebug('æŒ‰é’®ä½ç½®åˆ‡æ¢åˆ°å·¦ä¸‹è§’');
      } else {
        chatButton.classList.remove('test-chat-button--left');
        addDebug('æŒ‰é’®ä½ç½®åˆ‡æ¢åˆ°å³ä¸‹è§’');
      }
      
      updateStatus(`âœ… æŒ‰é’®ä½ç½®: ${isLeft ? 'å·¦ä¸‹è§’' : 'å³ä¸‹è§’'}`, 'success');
    }

    function toggleTheme() {
      if (!chatButton) {
        updateStatus('âŒ è¯·å…ˆåˆ›å»ºæŒ‰é’®', 'error');
        return;
      }

      isDark = !isDark;
      
      if (isDark) {
        chatButton.classList.add('test-chat-button--dark');
        addDebug('æŒ‰é’®ä¸»é¢˜åˆ‡æ¢åˆ°æ·±è‰²');
      } else {
        chatButton.classList.remove('test-chat-button--dark');
        addDebug('æŒ‰é’®ä¸»é¢˜åˆ‡æ¢åˆ°æµ…è‰²');
      }
      
      updateStatus(`âœ… æŒ‰é’®ä¸»é¢˜: ${isDark ? 'æ·±è‰²' : 'æµ…è‰²'}`, 'success');
    }

    function removeButton() {
      if (chatButton) {
        chatButton.remove();
        chatButton = null;
        addDebug('æŒ‰é’®å·²ç§»é™¤');
        updateStatus('âœ… æŒ‰é’®å·²ç§»é™¤', 'info');
      } else {
        updateStatus('âŒ æ²¡æœ‰æŒ‰é’®å¯ç§»é™¤', 'error');
      }
    }

    function inspectButton() {
      if (!chatButton) {
        updateStatus('âŒ è¯·å…ˆåˆ›å»ºæŒ‰é’®', 'error');
        return;
      }

      addDebug('=== æŒ‰é’®æ£€æŸ¥ç»“æœ ===');
      
      const styles = window.getComputedStyle(chatButton);
      const rect = chatButton.getBoundingClientRect();
      
      addDebug(`ä½ç½®: ${styles.position}`);
      addDebug(`z-index: ${styles.zIndex}`);
      addDebug(`å®½åº¦: ${styles.width}`);
      addDebug(`é«˜åº¦: ${styles.height}`);
      addDebug(`èƒŒæ™¯: ${styles.background}`);
      addDebug(`è¾¹æ¡†åŠå¾„: ${styles.borderRadius}`);
      addDebug(`åº•éƒ¨è·ç¦»: ${styles.bottom}`);
      addDebug(`å³ä¾§è·ç¦»: ${styles.right}`);
      addDebug(`å·¦ä¾§è·ç¦»: ${styles.left}`);
      addDebug(`å®é™…ä½ç½®: top=${Math.round(rect.top)}, left=${Math.round(rect.left)}`);
      addDebug(`è§†å£ä½ç½®: bottom=${Math.round(window.innerHeight - rect.bottom)}, right=${Math.round(window.innerWidth - rect.right)}`);
      
      updateStatus('âœ… æŒ‰é’®æ£€æŸ¥å®Œæˆï¼ŒæŸ¥çœ‹è°ƒè¯•ä¿¡æ¯', 'success');
    }

    // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨åˆ›å»ºæŒ‰é’®
    window.addEventListener('load', () => {
      addDebug('é¡µé¢åŠ è½½å®Œæˆ');
      updateStatus('ğŸ”„ é¡µé¢å·²åŠ è½½ï¼Œç‚¹å‡»"åˆ›å»ºæŒ‰é’®"å¼€å§‹æµ‹è¯•', 'info');
    });

    // ç›‘å¬çª—å£å¤§å°å˜åŒ–
    window.addEventListener('resize', () => {
      addDebug(`çª—å£å¤§å°: ${window.innerWidth}x${window.innerHeight}`);
    });

    // ç›‘å¬æ»šåŠ¨äº‹ä»¶
    window.addEventListener('scroll', () => {
      if (chatButton) {
        const rect = chatButton.getBoundingClientRect();
        addDebug(`æ»šåŠ¨æ—¶æŒ‰é’®ä½ç½®: bottom=${Math.round(window.innerHeight - rect.bottom)}`);
      }
    });
  </script>
</body>
</html>
