<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simple Button Test</title>
  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    
    .test-container {
      max-width: 600px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      padding: 2rem;
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
    }
    
    .title {
      font-size: 2rem;
      font-weight: bold;
      text-align: center;
      margin-bottom: 1rem;
      color: #1f2937;
    }
    
    .description {
      text-align: center;
      color: #6b7280;
      margin-bottom: 2rem;
    }
    
    .controls {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 2rem;
    }
    
    .btn {
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 6px;
      background: #3b82f6;
      color: white;
      cursor: pointer;
      font-weight: 500;
      transition: background 0.2s;
    }
    
    .btn:hover {
      background: #2563eb;
    }
    
    .status {
      padding: 1rem;
      border-radius: 8px;
      margin: 1rem 0;
      font-weight: 500;
    }
    
    .status.success {
      background: #d1fae5;
      color: #065f46;
    }
    
    .status.error {
      background: #fee2e2;
      color: #991b1b;
    }
    
    .status.info {
      background: #dbeafe;
      color: #1e40af;
    }
    
    .debug {
      background: #1f2937;
      color: #f3f4f6;
      padding: 1rem;
      border-radius: 8px;
      font-family: monospace;
      font-size: 0.875rem;
      white-space: pre-wrap;
      max-height: 200px;
      overflow-y: auto;
    }
    
    /* 测试按钮样式 */
    .test-chat-button {
      position: fixed !important;
      z-index: 9999 !important;
      width: 3.5rem !important;
      height: 3.5rem !important;
      border-radius: 50% !important;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15) !important;
      cursor: pointer !important;
      transition: all 0.3s ease-in-out !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      color: white !important;
      background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%) !important;
      border: none !important;
      outline: none !important;
      padding: 0 !important;
      margin: 0 !important;
      font-family: inherit !important;
      font-size: 1.5rem !important;
      line-height: 1 !important;
      bottom: 1.5rem !important;
      right: 1.5rem !important;
    }
    
    .test-chat-button:hover {
      background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%) !important;
      transform: scale(1.05) !important;
      box-shadow: 0 15px 35px rgba(59, 130, 246, 0.4) !important;
    }
    
    .test-chat-button--left {
      left: 1.5rem !important;
      right: auto !important;
    }
    
    .test-chat-button--dark {
      background: linear-gradient(135deg, #374151 0%, #1f2937 100%) !important;
    }
    
    .test-chat-button--dark:hover {
      background: linear-gradient(135deg, #4b5563 0%, #374151 100%) !important;
    }
    
    .content-area {
      height: 150vh;
      background: rgba(255,255,255,0.1);
      margin: 2rem 0;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.2rem;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="test-container">
    <h1 class="title">🔘 简单按钮测试</h1>
    <p class="description">
      测试聊天按钮的基本定位和样式功能
    </p>
    
    <div id="status" class="status info">
      准备测试聊天按钮...
    </div>
    
    <div class="controls">
      <button class="btn" onclick="createButton()">创建按钮</button>
      <button class="btn" onclick="togglePosition()">切换位置</button>
      <button class="btn" onclick="toggleTheme()">切换主题</button>
      <button class="btn" onclick="removeButton()">移除按钮</button>
      <button class="btn" onclick="inspectButton()">检查按钮</button>
    </div>
    
    <div id="debug" class="debug"></div>
  </div>
  
  <div class="content-area">
    滚动测试区域 - 按钮应保持固定位置
  </div>

  <script>
    let chatButton = null;
    let isLeft = false;
    let isDark = false;

    function updateStatus(message, type = 'info') {
      const status = document.getElementById('status');
      status.className = `status ${type}`;
      status.textContent = message;
    }

    function addDebug(message) {
      const debug = document.getElementById('debug');
      const timestamp = new Date().toLocaleTimeString();
      debug.textContent += `[${timestamp}] ${message}\n`;
      debug.scrollTop = debug.scrollHeight;
    }

    function createButton() {
      if (chatButton) {
        removeButton();
      }

      addDebug('创建聊天按钮...');
      
      chatButton = document.createElement('button');
      chatButton.className = 'test-chat-button';
      chatButton.innerHTML = '💬';
      chatButton.setAttribute('aria-label', '打开聊天');
      
      // 添加点击事件
      chatButton.addEventListener('click', () => {
        addDebug('按钮被点击！');
        updateStatus('✅ 按钮点击事件正常工作', 'success');
      });
      
      // 添加悬停事件
      chatButton.addEventListener('mouseenter', () => {
        addDebug('鼠标悬停在按钮上');
      });
      
      chatButton.addEventListener('mouseleave', () => {
        addDebug('鼠标离开按钮');
      });
      
      document.body.appendChild(chatButton);
      
      addDebug('按钮已创建并添加到页面');
      updateStatus('✅ 聊天按钮已创建', 'success');
    }

    function togglePosition() {
      if (!chatButton) {
        updateStatus('❌ 请先创建按钮', 'error');
        return;
      }

      isLeft = !isLeft;
      
      if (isLeft) {
        chatButton.classList.add('test-chat-button--left');
        addDebug('按钮位置切换到左下角');
      } else {
        chatButton.classList.remove('test-chat-button--left');
        addDebug('按钮位置切换到右下角');
      }
      
      updateStatus(`✅ 按钮位置: ${isLeft ? '左下角' : '右下角'}`, 'success');
    }

    function toggleTheme() {
      if (!chatButton) {
        updateStatus('❌ 请先创建按钮', 'error');
        return;
      }

      isDark = !isDark;
      
      if (isDark) {
        chatButton.classList.add('test-chat-button--dark');
        addDebug('按钮主题切换到深色');
      } else {
        chatButton.classList.remove('test-chat-button--dark');
        addDebug('按钮主题切换到浅色');
      }
      
      updateStatus(`✅ 按钮主题: ${isDark ? '深色' : '浅色'}`, 'success');
    }

    function removeButton() {
      if (chatButton) {
        chatButton.remove();
        chatButton = null;
        addDebug('按钮已移除');
        updateStatus('✅ 按钮已移除', 'info');
      } else {
        updateStatus('❌ 没有按钮可移除', 'error');
      }
    }

    function inspectButton() {
      if (!chatButton) {
        updateStatus('❌ 请先创建按钮', 'error');
        return;
      }

      addDebug('=== 按钮检查结果 ===');
      
      const styles = window.getComputedStyle(chatButton);
      const rect = chatButton.getBoundingClientRect();
      
      addDebug(`位置: ${styles.position}`);
      addDebug(`z-index: ${styles.zIndex}`);
      addDebug(`宽度: ${styles.width}`);
      addDebug(`高度: ${styles.height}`);
      addDebug(`背景: ${styles.background}`);
      addDebug(`边框半径: ${styles.borderRadius}`);
      addDebug(`底部距离: ${styles.bottom}`);
      addDebug(`右侧距离: ${styles.right}`);
      addDebug(`左侧距离: ${styles.left}`);
      addDebug(`实际位置: top=${Math.round(rect.top)}, left=${Math.round(rect.left)}`);
      addDebug(`视口位置: bottom=${Math.round(window.innerHeight - rect.bottom)}, right=${Math.round(window.innerWidth - rect.right)}`);
      
      updateStatus('✅ 按钮检查完成，查看调试信息', 'success');
    }

    // 页面加载完成后自动创建按钮
    window.addEventListener('load', () => {
      addDebug('页面加载完成');
      updateStatus('🔄 页面已加载，点击"创建按钮"开始测试', 'info');
    });

    // 监听窗口大小变化
    window.addEventListener('resize', () => {
      addDebug(`窗口大小: ${window.innerWidth}x${window.innerHeight}`);
    });

    // 监听滚动事件
    window.addEventListener('scroll', () => {
      if (chatButton) {
        const rect = chatButton.getBoundingClientRect();
        addDebug(`滚动时按钮位置: bottom=${Math.round(window.innerHeight - rect.bottom)}`);
      }
    });
  </script>
</body>
</html>
